# WK-005: 결과 보기 화면

## 기본 정보
- **화면 ID**: WK-005
- **화면명**: 이전 결과 조회
- **파일명**: `ResultHistory.jsx`
- **사용자**: 작업자
- **접근경로**: 대시보드 → "결과 보기"

## 와이어프레임
```
┌─────────────────────────────────┐
│  ← [뒤로]     결과 보기         │ ← 헤더
├─────────────────────────────────┤
│                                 │
│  📊 최근 체크리스트 결과        │ ← 제목
│                                 │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────────┐ │
│  │ 2025-09-06 08:15           │ │ ← 결과 카드
│  │ ✅ 적합 판정                │ │
│  │                             │ │
│  │ ████████████████ [만료시키기] │ │ ← QR + 버튼
│  │ ████████████████            │ │
│  │                             │ │
│  │ 상태: 유효함 (25분 남음)    │ │ ← 상태 표시
│  └─────────────────────────────┘ │
│                                 │
│  ┌─────────────────────────────┐ │
│  │ 2025-09-05 08:20           │ │ ← 이전 결과
│  │ ❌ 부적합 판정              │ │
│  │                             │ │
│  │ 사유: 발열 증상 확인        │ │
│  │ QR 코드 없음               │ │
│  └─────────────────────────────┘ │
│                                 │
├─────────────────────────────────┤
│      [새 체크리스트 작성]       │ ← 액션 버튼
└─────────────────────────────────┘
```

## 주요 구성요소

### 헤더
- 뒤로가기 버튼 (대시보드로)
- 제목: "결과 보기"

### 결과 목록
- **최신 순 정렬**: 가장 최근 결과가 상단
- **카드 형태**: 각 결과를 카드로 표시
- **무한 스크롤**: 이전 결과들 로딩

### 결과 카드 구성

#### 적합 판정 카드
- **날짜/시간**: "2025-09-06 08:15"
- **판정 결과**: "✅ 적합 판정"
- **QR 코드**: 200×150px 크기
- **만료시키기 버튼**: 시연용 기능
- **상태 표시**: "유효함 (25분 남음)" / "만료됨"

#### 부적합 판정 카드
- **날짜/시간**: "2025-09-05 08:20"
- **판정 결과**: "❌ 부적합 판정"
- **부적합 사유**: "발열 증상 확인"
- **QR 코드**: 없음 표시

### 액션 버튼
- **새 체크리스트 작성**: WK-003으로 이동

## 기능 명세

### 결과 데이터 구조
```javascript
const resultHistory = [
  {
    id: 1,
    date: '2025-09-06T08:15:00Z',
    status: 'approved',
    qrCode: 'data:image/png;base64...',
    expireTime: '2025-09-06T08:45:00Z',
    isExpired: false,
    aiVerified: true
  },
  {
    id: 2,
    date: '2025-09-05T08:20:00Z',
    status: 'rejected',
    reason: '발열 증상 확인',
    qrCode: null
  }
];
```

### 만료시키기 기능 (시연용)
```javascript
const expireQRCode = (resultId) => {
  setResultHistory(prev => 
    prev.map(result => 
      result.id === resultId 
        ? { ...result, isExpired: true, expireTime: new Date().toISOString() }
        : result
    )
  );
};
```

### 실시간 타이머
```javascript
const calculateTimeLeft = (expireTime) => {
  const now = new Date();
  const expire = new Date(expireTime);
  const diff = expire - now;
  
  if (diff <= 0) return '만료됨';
  
  const minutes = Math.floor(diff / 60000);
  const seconds = Math.floor((diff % 60000) / 1000);
  return `${minutes}분 ${seconds}초 남음`;
};
```

### QR 상태 관리
```javascript
const getQRStatus = (result) => {
  if (!result.qrCode) return null;
  
  if (result.isExpired) {
    return {
      status: 'expired',
      text: '만료됨',
      color: 'gray'
    };
  }
  
  const timeLeft = calculateTimeLeft(result.expireTime);
  return {
    status: 'valid',
    text: `유효함 (${timeLeft})`,
    color: 'green'
  };
};
```

## UI 요구사항

### 카드 스타일
- 배경: 흰색
- 테두리: 연한 회색
- 둥근 모서리: 12px
- 그림자: 약간의 드롭 섀도우
- 간격: 카드 간 16px

### 상태별 색상
- **적합**: 녹색 (#10b981)
- **부적합**: 빨간색 (#ef4444)
- **만료**: 회색 (#6b7280)

### QR 코드 표시
- **유효**: 정상 색상
- **만료**: 회색 필터 + "만료됨" 오버레이
- 크기: 200×150px (카드 내 적절한 크기)

### 만료시키기 버튼
- 크기: 작은 버튼 (80px)
- 색상: 빨간색 (#ef4444)
- 위치: QR 코드 우측 상단
- 텍스트: "만료시키기"

### 빈 상태 처리
```
📋 아직 체크리스트 결과가 없습니다

첫 번째 위생상태 점검을 시작해보세요

[체크리스트 작성하기]
```

## 상호작용 정의

### QR 코드 클릭
- 유효한 QR: 확대 보기 모달
- 만료된 QR: 클릭 불가 (회색 처리)

### 만료시키기 버튼
- 클릭 시 확인 다이얼로그
- 확인 후 즉시 만료 처리
- QR 코드 회색 처리 + "만료됨" 표시

### 카드 스와이프 (선택사항)
- 좌측 스와이프: 삭제 옵션
- 우측 스와이프: 상세 보기

## 오류 처리

### 데이터 로딩 실패
```
❌ 결과를 불러올 수 없습니다
네트워크 연결을 확인해주세요

[다시 시도]
```

### 만료 처리 실패
```
❌ 처리에 실패했습니다
잠시 후 다시 시도해주세요
```

## 참고 문서
- **시연시나리오**: 시나리오 5 "결과 보기 페이지"
- **사용자스토리**: US-008 이전 결과 조회
- **공통정의서**: 카드 컴포넌트, 상태 표시

---
**작성일**: 2025-09-06  
**상태**: 개발 준비 완료
