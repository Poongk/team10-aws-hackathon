# 07. QR 스캐너 화면 와이어프레임

## 화면 개요
- **목적**: 모바일 카메라로 QR 코드 스캔 + 실시간 출입 판정
- **사용자**: 보안담당자 (정보안)
- **플랫폼**: 모바일 전용 (카메라 기능 필수)

## 와이어프레임

### QR 스캐너 메인 화면
```
┌─────────────────────────┐
│ ← 뒤로   QR 스캐너     🏠 │
│                         │
│ 👮 정보안님 (보안팀)     │
│ 📅 2025-09-05 20:30     │
│                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                         │
│ ┌─────────────────┐    │
│ │                 │    │
│ │     📷 카메라    │    │
│ │                 │    │
│ │  ┌─────────────┐ │    │
│ │  │             │ │    │
│ │  │   QR 코드를  │ │    │
│ │  │   여기에     │ │    │
│ │  │   맞춰주세요  │ │    │
│ │  │             │ │    │
│ │  └─────────────┘ │    │
│ │                 │    │
│ │   스캔 영역 가이드   │    │
│ └─────────────────┘    │
│                         │
│ 💡 QR 코드를 스캔 영역에 │
│    맞춰주세요           │
│                         │
│ 📊 오늘 스캔 현황:       │
│ • 승인: 42명 ✅         │
│ • 거부: 3명 🚫          │
│ • 재확인: 5명 ⚠️        │
│                         │
│ ┌─────────────────┐    │
│ │ 💡 플래시 ON/OFF │    │
│ └─────────────────┘    │
│ ┌─────────────────┐    │
│ │ 📋 수동 입력     │    │
│ └─────────────────┘    │
│                         │
└─────────────────────────┘
```

### QR 스캔 중 화면
```
┌─────────────────────────┐
│ ← 뒤로   QR 스캐너     🏠 │
│                         │
│ ┌─────────────────┐    │
│ │                 │    │
│ │     📷 카메라    │    │
│ │                 │    │
│ │  ┌─────────────┐ │    │
│ │  │ ████████████ │ │    │
│ │  │ ██        ██ │ │    │
│ │  │ ██  감지됨 ██ │ │    │
│ │  │ ██        ██ │ │    │
│ │  │ ████████████ │ │    │
│ │  └─────────────┘ │    │
│ │                 │    │
│ │   🔍 스캔 중...    │    │
│ └─────────────────┘    │
│                         │
│ ⏳ QR 코드 분석 중...   │
│                         │
│ ████████░░ 80%          │
│                         │
└─────────────────────────┘
```

### 수동 입력 화면 (QR 스캔 실패 시)
```
┌─────────────────────────┐
│ ← 뒤로   수동 입력     📷 │
│                         │
│ 👮 정보안님 (보안팀)     │
│                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                         │
│ 📝 QR 코드 수동 입력     │
│                         │
│ QR 코드 ID:             │
│ ┌─────────────────┐    │
│ │ QR_20250905_001  │    │
│ └─────────────────┘    │
│                         │
│ 또는 사용자 정보:        │
│                         │
│ 이름:                   │
│ ┌─────────────────┐    │
│ │ 김작업           │    │
│ └─────────────────┘    │
│                         │
│ 사번:                   │
│ ┌─────────────────┐    │
│ │ EMP001          │    │
│ └─────────────────┘    │
│                         │
│ ┌─────────────────┐    │
│ │ 🔍 조회하기      │    │
│ └─────────────────┘    │
│                         │
│ 💡 QR 스캔이 안 될 때   │
│    사용해주세요         │
│                         │
└─────────────────────────┘
```

### 스캔 이력 화면
```
┌─────────────────────────┐
│ ← 뒤로   스캔 이력     📷 │
│                         │
│ 📊 오늘 스캔 현황        │
│ (2025-09-05)           │
│                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                         │
│ 📈 통계                 │
│ • 총 스캔: 50명         │
│ • 승인: 42명 (84%) ✅   │
│ • 거부: 3명 (6%) 🚫     │
│ • 재확인: 5명 (10%) ⚠️  │
│                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                         │
│ 📋 최근 스캔 기록        │
│                         │
│ ┌─────────────────┐    │
│ │ 20:28 김작업 ✅  │    │
│ │ 생산팀A • 승인    │    │
│ └─────────────────┘    │
│ ┌─────────────────┐    │
│ │ 20:25 박작업 ⚠️  │    │
│ │ 생산팀B • 재확인  │    │
│ └─────────────────┘    │
│ ┌─────────────────┐    │
│ │ 20:22 이작업 🚫  │    │
│ │ 생산팀C • 거부    │    │
│ └─────────────────┘    │
│                         │
│ ┌─────────────────┐    │
│ │ 📊 전체 이력보기  │    │
│ └─────────────────┘    │
│                         │
└─────────────────────────┘
```

### 네트워크 오류 화면
```
┌─────────────────────────┐
│                         │
│                         │
│    📶❌ 네트워크 오류    │
│                         │
│  인터넷 연결을 확인해주세요 │
│                         │
│                         │
│ ┌─────────────────┐    │
│ │ 🔄 다시 시도     │    │
│ └─────────────────┘    │
│                         │
│ ┌─────────────────┐    │
│ │ 📱 오프라인 모드  │    │
│ └─────────────────┘    │
│                         │
│ 💡 오프라인 모드에서는   │
│    스캔 기록이 임시     │
│    저장됩니다          │
│                         │
│                         │
└─────────────────────────┘
```

## 상호작용 설계

### 카메라 스캔 프로세스
1. **카메라 권한 요청** → 사용자 승인 필요
2. **QR 코드 감지** → 스캔 영역에 QR 코드 인식
3. **자동 스캔** → QR 코드 자동 읽기 (0.5초 내)
4. **서버 전송** → QR 데이터 서버로 전송 및 검증
5. **결과 표시** → 08_출입결과화면으로 이동

### 스캔 최적화
1. **자동 포커스** → QR 코드에 자동 초점
2. **플래시 제어** → 어두운 환경에서 플래시 사용
3. **진동 피드백** → 스캔 성공 시 진동
4. **음성 피드백** → "스캔 완료" 음성 안내

### 오류 처리
1. **스캔 실패** → 3초 후 수동 입력 옵션 제공
2. **네트워크 오류** → 오프라인 모드 전환
3. **카메라 오류** → 수동 입력 모드로 전환
4. **권한 거부** → 설정 화면으로 안내

### 오프라인 모드
1. **로컬 저장** → 스캔 기록 임시 저장
2. **동기화** → 네트워크 복구 시 자동 동기화
3. **충돌 해결** → 중복 스캔 기록 처리

## 데이터 구조

### QR 스캔 요청
```javascript
const scanRequest = {
  qr_code: "QR_20250905_001",
  scanned_by: "security1",
  scanned_at: "2025-09-05T20:30:00Z",
  location: "main_entrance",
  device_id: "tablet_001"
};
```

### QR 스캔 응답
```javascript
const scanResponse = {
  success: true,
  data: {
    scan_id: "scan_20250905_001",
    user_info: {
      user_id: "worker1",
      name: "김작업",
      team: "생산팀A",
      photo_url: "https://..."
    },
    judgment: {
      result: "approved", // approved/review_required/rejected/expired/invalid
      reason: "모든 위생상태가 정상입니다",
      qr_expires_at: "2025-09-05T17:30:00Z",
      access_granted: true
    },
    additional_checks: [], // 재확인 시 추가 체크 항목
    scanned_at: "2025-09-05T20:30:00Z"
  }
};
```

### 스캔 통계 데이터
```javascript
const scanStats = {
  date: "2025-09-05",
  total_scans: 50,
  approved: 42,
  rejected: 3,
  review_required: 5,
  expired: 0,
  invalid: 0,
  scan_rate_by_hour: [
    { hour: "08", count: 25 },
    { hour: "09", count: 15 },
    { hour: "10", count: 5 },
    // ...
  ],
  recent_scans: [
    {
      scan_id: "scan_001",
      user_name: "김작업",
      team: "생산팀A",
      result: "approved",
      scanned_at: "2025-09-05T20:28:00Z"
    }
    // ...
  ]
};
```

### 오프라인 저장 구조
```javascript
const offlineScans = {
  device_id: "tablet_001",
  scans: [
    {
      qr_code: "QR_20250905_001",
      scanned_at: "2025-09-05T20:30:00Z",
      synced: false
    }
  ],
  last_sync: "2025-09-05T20:25:00Z"
};
```

## CSS 스타일 가이드

### 카메라 뷰 스타일
```css
.camera-container {
  position: relative;
  width: 100%;
  height: 300px;
  background: #000;
  border-radius: 12px;
  overflow: hidden;
}

.camera-view {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.scan-overlay {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 200px;
  height: 200px;
  border: 3px solid #1890ff;
  border-radius: 12px;
  background: rgba(24, 144, 255, 0.1);
}

.scan-corners {
  position: absolute;
  width: 20px;
  height: 20px;
  border: 3px solid #52c41a;
}

.scan-corners.top-left {
  top: -3px;
  left: -3px;
  border-right: none;
  border-bottom: none;
}

.scan-corners.top-right {
  top: -3px;
  right: -3px;
  border-left: none;
  border-bottom: none;
}

.scan-corners.bottom-left {
  bottom: -3px;
  left: -3px;
  border-right: none;
  border-top: none;
}

.scan-corners.bottom-right {
  bottom: -3px;
  right: -3px;
  border-left: none;
  border-top: none;
}

.scanning-animation {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, #52c41a, transparent);
  animation: scan-line 2s linear infinite;
}

@keyframes scan-line {
  0% { transform: translateY(0); }
  100% { transform: translateY(200px); }
}
```

### 스캔 상태 표시
```css
.scan-status {
  text-align: center;
  padding: 16px;
  margin: 16px 0;
  border-radius: 8px;
  font-weight: 500;
}

.scan-status.scanning {
  background: #e6f7ff;
  color: #1890ff;
  border: 1px solid #91d5ff;
}

.scan-status.success {
  background: #f6ffed;
  color: #52c41a;
  border: 1px solid #b7eb8f;
  animation: success-pulse 0.5s ease-out;
}

.scan-status.error {
  background: #fff2f0;
  color: #f5222d;
  border: 1px solid #ffccc7;
  animation: error-shake 0.5s ease-out;
}

@keyframes success-pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

@keyframes error-shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}
```

### 통계 카드 스타일
```css
.stats-card {
  background: white;
  border-radius: 8px;
  padding: 16px;
  margin: 8px 0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
  margin: 16px 0;
}

.stat-item {
  text-align: center;
  padding: 12px;
  border-radius: 6px;
}

.stat-item.approved {
  background: #f6ffed;
  color: #52c41a;
}

.stat-item.rejected {
  background: #fff2f0;
  color: #f5222d;
}

.stat-item.review {
  background: #fffbe6;
  color: #faad14;
}

.stat-number {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 4px;
}

.stat-label {
  font-size: 12px;
  opacity: 0.8;
}
```

### 스캔 기록 리스트
```css
.scan-history {
  margin: 16px 0;
}

.scan-item {
  display: flex;
  align-items: center;
  padding: 12px;
  margin: 8px 0;
  background: white;
  border-radius: 8px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.1);
}

.scan-time {
  font-size: 12px;
  color: #8c8c8c;
  margin-right: 12px;
  min-width: 40px;
}

.scan-user {
  flex: 1;
  margin-right: 12px;
}

.scan-user-name {
  font-weight: 500;
  margin-bottom: 2px;
}

.scan-user-team {
  font-size: 12px;
  color: #8c8c8c;
}

.scan-result {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 500;
}

.scan-result.approved {
  background: #f6ffed;
  color: #52c41a;
}

.scan-result.rejected {
  background: #fff2f0;
  color: #f5222d;
}

.scan-result.review {
  background: #fffbe6;
  color: #faad14;
}
```

## 접근성 고려사항
- **카메라 권한**: 명확한 권한 요청 메시지
- **음성 피드백**: 스크린 리더 사용자를 위한 음성 안내
- **대체 입력**: 카메라 사용 불가 시 수동 입력 제공
- **고대비 모드**: 시각 장애인을 위한 고대비 스캔 가이드
- **진동 피드백**: 청각 장애인을 위한 햅틱 피드백

## 성능 최적화
- **카메라 최적화**: 해상도 조정으로 배터리 절약
- **QR 인식 최적화**: 실시간 QR 코드 감지 알고리즘
- **메모리 관리**: 카메라 스트림 적절한 해제
- **네트워크 최적화**: 스캔 데이터 압축 전송
- **오프라인 캐싱**: 네트워크 불안정 환경 대응

## 보안 고려사항
- **QR 검증**: 서버에서 QR 코드 유효성 검증
- **재사용 방지**: 스캔된 QR 코드 일회용 처리
- **로그 관리**: 모든 스캔 기록 보안 로그 저장
- **권한 관리**: 보안담당자만 스캔 기능 접근
- **데이터 암호화**: 스캔 데이터 전송 시 암호화

---
**화면 ID**: 07  
**이전 화면**: 01_로그인화면.md (보안담당자 로그인 후)  
**다음 화면**: 08_출입결과화면.md  
**관련 문서**: 00_공통가이드.md, 00_화면구성개요.md
