# 04. 결과 화면 와이어프레임

## 화면 개요
- **목적**: AI 판정 결과 표시 + QR 코드 생성 + 출입 안내
- **사용자**: 작업자 (김작업, 박작업)
- **플랫폼**: 모바일 우선 (QR 코드 표시 최적화)

## 와이어프레임

### 승인 결과 화면 (출입 가능)
```
┌─────────────────────────┐
│ ← 뒤로    판정 결과     🏠 │
│                         │
│ 👤 김작업님 (생산팀A)     │
│ 📅 2025-09-05 20:10     │
│                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                         │
│    ✅ 출입 승인됨!       │
│                         │
│  모든 위생상태가 정상입니다 │
│                         │
│ ┌─────────────────┐    │
│ │                 │    │
│ │   ████████████   │    │
│ │   ██        ██   │    │
│ │   ██  QR코드 ██   │    │
│ │   ██        ██   │    │
│ │   ████████████   │    │
│ │                 │    │
│ │ QR_20250905_001  │    │
│ └─────────────────┘    │
│                         │
│ 💡 출입구에서 QR코드를   │
│    스캔해주세요         │
│                         │
│ ⏰ 오늘 17:30까지 유효  │
│                         │
│                         │
│ ┌─────────────────┐    │
│ │ 📱 QR코드 저장   │    │
│ └─────────────────┘    │
│ ┌─────────────────┐    │
│ │ 🏠 메인으로      │    │
│ └─────────────────┘    │
│                         │
└─────────────────────────┘
```

### 거부 결과 화면 (출입 불가)
```
┌─────────────────────────┐
│ ← 뒤로    판정 결과     🏠 │
│                         │
│ 👤 김작업님 (생산팀A)     │
│ 📅 2025-09-05 20:10     │
│                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                         │
│    🚫 출입 불가         │
│                         │
│  발열/설사/구토 증상이   │
│    감지되었습니다       │
│                         │
│ ┌─────────────────┐    │
│ │                 │    │
│ │      🚫 ❌       │    │
│ │                 │    │
│ │   출입 불가      │    │
│ │                 │    │
│ │ 운영팀 연락 필요  │    │
│ │                 │    │
│ └─────────────────┘    │
│                         │
│ 📋 조치 안내:           │
│ • 즉시 귀가 조치        │
│ • 의료진 상담 권장      │
│ • 증상 완화 후 재검토   │
│                         │
│ 📞 문의: 운영팀 1234    │
│                         │
│ ┌─────────────────┐    │
│ │ 📝 재검토 요청    │    │
│ └─────────────────┘    │
│ ┌─────────────────┐    │
│ │ 🏠 메인으로      │    │
│ └─────────────────┘    │
│                         │
└─────────────────────────┘
```

### 재확인 결과 화면 (조건부 승인)
```
┌─────────────────────────┐
│ ← 뒤로    판정 결과     🏠 │
│                         │
│ 👤 김작업님 (생산팀A)     │
│ 📅 2025-09-05 20:10     │
│                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                         │
│    ⚠️ 재확인 필요        │
│                         │
│  복장 상태를 점검해주세요 │
│                         │
│ ┌─────────────────┐    │
│ │                 │    │
│ │   ████████████   │    │
│ │   ██        ██   │    │
│ │   ██  QR코드 ██   │    │
│ │   ██        ██   │    │
│ │   ████████████   │    │
│ │                 │    │
│ │ QR_20250905_002  │    │
│ └─────────────────┘    │
│                         │
│ 💡 출입구에서 재확인 후  │
│    출입 가능합니다      │
│                         │
│ ⚠️ 조건부 승인          │
│ • 복장 정리 후 출입     │
│ • 보안담당자 확인 필요   │
│                         │
│ ⏰ 오늘 17:30까지 유효  │
│                         │
│                         │
│ ┌─────────────────┐    │
│ │ 📱 QR코드 저장   │    │
│ └─────────────────┘    │
│ ┌─────────────────┐    │
│ │ 🏠 메인으로      │    │
│ └─────────────────┘    │
│                         │
└─────────────────────────┘
```

### AI 판정 중 로딩 화면
```
┌─────────────────────────┐
│                         │
│                         │
│    🤖 AI 판정 중...     │
│                         │
│  체크리스트를 분석하고   │
│    있습니다            │
│                         │
│     ⏳ ████████░░       │
│                         │
│  잠시만 기다려주세요...  │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
└─────────────────────────┘
```

### QR 코드 확대 화면 (모달)
```
┌─────────────────────────┐
│          ✕              │
│                         │
│ ┌─────────────────┐    │
│ │                 │    │
│ │                 │    │
│ │   ████████████   │    │
│ │   ██        ██   │    │
│ │   ██        ██   │    │
│ │   ██  QR코드 ██   │    │
│ │   ██        ██   │    │
│ │   ██        ██   │    │
│ │   ████████████   │    │
│ │                 │    │
│ │                 │    │
│ └─────────────────┘    │
│                         │
│ QR_20250905_001         │
│                         │
│ ✅ 출입 승인            │
│ ⏰ 오늘 17:30까지 유효  │
│                         │
│ ┌─────────────────┐    │
│ │ 📱 갤러리에 저장  │    │
│ └─────────────────┘    │
│ ┌─────────────────┐    │
│ │ 📤 공유하기      │    │
│ └─────────────────┘    │
│                         │
└─────────────────────────┘
```

## 상호작용 설계

### AI 판정 프로세스
1. **체크리스트 제출** → 로딩 화면 표시
2. **AI 분석** (2-5초) → 진행률 바 애니메이션
3. **결과 표시** → 승인/거부/재확인 화면 이동
4. **QR 코드 생성** (승인/재확인 시) → 당일 17:30까지 유효

### QR 코드 상호작용
1. **QR 코드 클릭** → 확대 모달 표시
2. **저장 버튼** → 갤러리에 이미지 저장
3. **공유 버튼** → 메신저/이메일 공유
4. **자동 새로고침** → 유효시간 만료 시 비활성화

### 재검토 요청
1. **재검토 요청 버튼** (거부 시에만 표시)
2. **사유 입력** → 03_체크리스트화면의 재검토 플로우 연결
3. **운영자 승인** → 새로운 체크리스트 작성 기회

### 메인 복귀
1. **메인으로 버튼** → 02_작업자대시보드화면으로 이동
2. **뒤로가기** → 이전 화면 (체크리스트 또는 대시보드)

## AI 판정 로직

### 판정 기준
```javascript
const judgmentLogic = {
  // 자동 거부 (Critical)
  autoReject: [
    { item: 'symptoms', value: 'exists', weight: 10 }, // 발열/설사/구토
    { item: 'respiratory', value: 'severe', weight: 9 } // 심각한 호흡기 질환
  ],
  
  // 재확인 필요 (Warning)
  needReview: [
    { item: 'clothing', value: 'inappropriate', weight: 7 }, // 부적절한 복장
    { item: 'wound', value: 'exists', weight: 8 }, // 상처 있음
    { item: 'respiratory', value: 'mild', weight: 6 } // 경미한 호흡기 질환
  ],
  
  // 경고 (Minor)
  warning: [
    { item: 'accessories', value: 'wearing', weight: 6 }, // 장신구 착용
    { item: 'hair', value: 'messy', weight: 5 }, // 두발 미정리
    { item: 'nails', value: 'dirty', weight: 4 }, // 손톱 불결
    { item: 'makeup', value: 'inappropriate', weight: 3 }, // 부적절한 화장
    { item: 'personal_items', value: 'carrying', weight: 2 } // 개인물품 소지
  ]
};

// 판정 알고리즘
function aiJudgment(responses) {
  let criticalScore = 0;
  let warningScore = 0;
  let minorScore = 0;
  
  responses.forEach(response => {
    if (isAutoReject(response)) criticalScore += response.weight;
    else if (needsReview(response)) warningScore += response.weight;
    else if (isWarning(response)) minorScore += response.weight;
  });
  
  if (criticalScore > 0) return 'rejected';
  if (warningScore >= 15) return 'review_required';
  if (minorScore >= 10) return 'review_required';
  return 'approved';
}
```

### 결과별 QR 코드
```javascript
const qrCodeConfig = {
  approved: {
    color: 'green',
    validity: 'configurable', // 관리자 기본값 + 운영자 조정 가능
    default_expires: '17:30', // 관리자가 템플릿에서 설정한 기본값
    access_level: 'full'
  },
  review_required: {
    color: 'orange', 
    validity: 'configurable', // 관리자 기본값 + 운영자 조정 가능
    default_expires: '17:30', // 관리자가 템플릿에서 설정한 기본값
    access_level: 'conditional'
  },
  rejected: {
    color: 'red',
    validity: 0, // QR 코드 없음
    access_level: 'denied'
  }
};

// 유효시간 설정 권한
const validitySettings = {
  admin: {
    // 관리자 (최관리): 템플릿 기본값 설정
    can_set_default: true,
    can_set_system_policy: true,
    scope: 'all_templates'
  },
  operator: {
    // 운영자 (박운영): 당일 실시간 조정
    can_adjust_daily: true,
    can_extend_emergency: true,
    scope: 'assigned_templates',
    max_extension: '2_hours' // 최대 2시간 연장 가능
  }
};

// 설정 가능한 시간 옵션
const timeOptions = [
  '14:00', // 토요일 특근
  '17:30', // 평상시 (기본값)
  '18:00', // 소폭 연장
  '19:00', // 야근 준비
  '20:00', // 야근
  '22:00'  // 긴급 상황
];
```

## 데이터 구조

### 판정 결과 데이터
```javascript
const judgmentResult = {
  record_id: "record_20250905_001",
  user_id: "worker1",
  user_name: "김작업",
  team: "생산팀A",
  judgment: {
    result: "approved", // approved/review_required/rejected
    confidence: 0.95,
    reason: "모든 위생상태가 정상 범위입니다",
    risk_factors: [],
    recommendations: []
  },
  qr_code: {
    code: "QR_20250905_001",
    data: "eyJyZWNvcmRfaWQi...", // 암호화된 데이터
    color: "green",
    expires_at: "2025-09-05T17:30:00Z", // 관리자 기본값 + 운영자 당일 조정
    generated_at: "2025-09-05T20:10:00Z"
  },
  actions: {
    can_retry: false, // 거부 시에만 true
    retry_count: 0,
    next_available: null
  },
  submitted_at: "2025-09-05T20:10:00Z",
  judged_at: "2025-09-05T20:10:05Z"
};
```

### QR 코드 데이터 구조
```javascript
const qrData = {
  record_id: "record_20250905_001",
  user_id: "worker1", 
  judgment: "approved",
  expires_at: 1693902000,
  signature: "abc123...", // 보안 서명
  version: "1.0"
};

// Base64 인코딩 후 QR 코드 생성
const qrString = btoa(JSON.stringify(qrData));
```

## CSS 스타일 가이드

### 결과별 색상 테마
```css
.result-approved {
  background: linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%);
  border: 2px solid #52c41a;
}

.result-approved .result-icon {
  color: #52c41a;
  font-size: 48px;
  animation: success-bounce 0.6s ease-out;
}

.result-rejected {
  background: linear-gradient(135deg, #fff2f0 0%, #ffccc7 100%);
  border: 2px solid #f5222d;
}

.result-rejected .result-icon {
  color: #f5222d;
  font-size: 48px;
  animation: error-shake 0.6s ease-out;
}

.result-review {
  background: linear-gradient(135deg, #fffbe6 0%, #fff1b8 100%);
  border: 2px solid #faad14;
}

.result-review .result-icon {
  color: #faad14;
  font-size: 48px;
  animation: warning-pulse 1s infinite;
}

@keyframes success-bounce {
  0% { transform: scale(0); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

@keyframes error-shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

@keyframes warning-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}
```

### QR 코드 스타일
```css
.qr-code-container {
  background: white;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  text-align: center;
}

.qr-code {
  width: 200px;
  height: 200px;
  margin: 0 auto;
  border: 2px solid #e8e8e8;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
}

.qr-code:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}

.qr-code.approved {
  border-color: #52c41a;
  box-shadow: 0 0 0 4px rgba(82, 196, 26, 0.2);
}

.qr-code.review {
  border-color: #faad14;
  box-shadow: 0 0 0 4px rgba(250, 173, 20, 0.2);
}

.qr-validity {
  margin-top: 12px;
  font-size: 14px;
  color: #595959;
}

.qr-validity.expiring {
  color: #f5222d;
  animation: blink 1s infinite;
}

@keyframes blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0.5; }
}
```

### 로딩 애니메이션
```css
.ai-loading {
  text-align: center;
  padding: 60px 20px;
}

.loading-icon {
  font-size: 48px;
  margin-bottom: 20px;
  animation: rotate 2s linear infinite;
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.progress-bar {
  width: 200px;
  height: 8px;
  background: #f0f0f0;
  border-radius: 4px;
  margin: 20px auto;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #1890ff, #52c41a);
  border-radius: 4px;
  animation: progress 3s ease-out forwards;
}

@keyframes progress {
  0% { width: 0%; }
  30% { width: 30%; }
  60% { width: 70%; }
  100% { width: 100%; }
}
```

### 액션 버튼
```css
.action-button {
  width: 100%;
  padding: 16px;
  margin: 8px 0;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.action-button.primary {
  background: #1890ff;
  color: white;
}

.action-button.primary:hover {
  background: #096dd9;
  transform: translateY(-1px);
}

.action-button.success {
  background: #52c41a;
  color: white;
}

.action-button.warning {
  background: #faad14;
  color: white;
}

.action-button.danger {
  background: #f5222d;
  color: white;
}

.action-button.secondary {
  background: #f0f0f0;
  color: #595959;
  border: 1px solid #d9d9d9;
}
```

## 접근성 고려사항
- **스크린 리더**: 판정 결과 음성 안내 "출입이 승인되었습니다"
- **색상 대비**: WCAG 2.1 AA 기준 준수
- **키보드 네비게이션**: Tab으로 모든 버튼 접근
- **터치 영역**: QR 코드 200px, 버튼 44px 이상
- **상태 표시**: 색상 + 아이콘 + 텍스트 조합

## 성능 최적화
- **QR 코드 캐싱**: 생성된 QR 코드 로컬 저장
- **이미지 최적화**: QR 코드 SVG 형식 사용
- **지연 로딩**: 결과 화면 진입 시 QR 코드 생성
- **오프라인 지원**: 생성된 QR 코드 오프라인 표시

## 보안 고려사항
- **QR 코드 암호화**: 민감 정보 암호화 후 QR 생성
- **유효시간 검증**: 서버에서 QR 코드 유효성 검증
- **재사용 방지**: 일회용 QR 코드 (스캔 후 무효화)
- **서명 검증**: 디지털 서명으로 위조 방지

---
**화면 ID**: 04  
**이전 화면**: 03_체크리스트화면.md  
**다음 화면**: 05_대시보드화면.md (운영자용)  
**관련 문서**: 00_공통가이드.md, 00_화면구성개요.md
